# Apply corrFunc to all rows of vars
corrs_rec = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#tot_repeat_dens
vars = data.frame(v1=names((COR_TEST)["density_rpt"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_tot_repeat_dens = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gen_dens
vars = data.frame(v1=names((COR_TEST)["density_genes"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_gene_dens = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gc
vars = data.frame(v1=names((COR_TEST)["GC"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_gc = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gc
vars = data.frame(v1=names((COR_TEST)["GC"]), v2=names((COR_TEST)["rec_rate"] ))
corrs_gc_rr = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gene_prop vs repeat_prop
vars = data.frame(v1=names((COR_TEST)["prop_CDS"]), v2=names((COR_TEST)["prop_rpt"]))
corrs_prop = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
corrs_W <- rbind(corrs_rec, corrs_tot_repeat_dens, corrs_gene_dens, corrs_prop, corrs_gc, corrs_gc_rr)
#############################
#without W
COR_TEST <- as.data.frame(rr_repeats_genes_wide[rr_repeats_genes_wide$chr_type!="W",])
COR_TEST$density_CDS <- NULL
#rec_rate
#rec_rate
#vars = data.frame(v1=names(mtcars)[1], v2=names(mtcars)[-1])
vars = data.frame(v1=names((COR_TEST)["rec_rate"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
# Apply corrFunc to all rows of vars
corrs_rec = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#tot_repeat_dens
vars = data.frame(v1=names((COR_TEST)["density_rpt"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_tot_repeat_dens = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gen_dens
vars = data.frame(v1=names((COR_TEST)["density_genes"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_gene_dens = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gc
vars = data.frame(v1=names((COR_TEST)["GC"]), v2=names(select(COR_TEST, starts_with(c("density_","prop_")))))
corrs_gc = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gc
vars = data.frame(v1=names((COR_TEST)["GC"]), v2=names((COR_TEST)["rec_rate"] ))
corrs_gc_rr = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#gene_prop vs repeat_prop
vars = data.frame(v1=names((COR_TEST)["prop_CDS"]), v2=names((COR_TEST)["prop_rpt"]))
corrs_prop = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
corrs_noW <- rbind(corrs_rec, corrs_tot_repeat_dens, corrs_gene_dens, corrs_prop, corrs_gc, corrs_gc_rr)
colnames(corrs_noW) <- c("var1", "var2", "estimate_noW", "p.value_noW", "statistic_noW", "method")
#join(corrs_W, corrs_noW)
#write.table(join(corrs_W, corrs_noW), "correlations.table")
write.table(join(corrs_W, corrs_noW), "tables/correlations_spearman.table")
#write.table(join(corrs_W, corrs_noW), "correlations_kendall.table")
#cor test versus length/genetic feature is rec rate corr to repeat length?
cor.test(rr_repeats_genes_wide$rec_rate,rr_repeats_genes_wide$length_rpt/rr_repeats_genes_wide$count_rpt)
#t = -3.6812, df = 215, p-value = 0.0002936, coeff -0.2435007
#without W - non sign
cor.test(rr_repeats_genes_wide[rr_repeats_genes_wide$chr_type!="W",]$rec_rate,rr_repeats_genes_wide[rr_repeats_genes_wide$chr_type!="W",]$length_rpt/rr_repeats_genes_wide[rr_repeats_genes_wide$chr_type!="W",]$count_rpt)
#t = -0.031845, df = 208, p-value = 0.9746, coeff -0.002208071
######
#Cor with chr length
COR_TEST <- as.data.frame(repeat_chr_level)
## Pairs of variables for which we want correlations
#rec_rate
#vars = data.frame(v1=names(mtcars)[1], v2=names(mtcars)[-1])
vars = data.frame(v1=names((COR_TEST)["chr_length"]), v2=names(select(COR_TEST, ends_with(c("_dens","_prop")))))
# Apply corrFunc to all rows of vars
corrs_length = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
vars = data.frame(v1=names((COR_TEST)["chr_length"]), v2=names(select(COR_TEST, "rr_mean")))
# Apply corrFunc to all rows of vars
corrs_length_rr = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
vars = data.frame(v1=names((COR_TEST)["chr_length"]), v2=names(select(COR_TEST, "GC")))
# Apply corrFunc to all rows of vars
corrs_length_gc = do.call(rbind, mapply(corrFunc, vars[,1], vars[,2], MoreArgs=list(data=COR_TEST),
SIMPLIFY=FALSE))
#corr_length_tot <- rbind(corrs_length_rr, corrs_length)
corr_chr_length <- rbind(corrs_length_rr, corrs_length,corrs_length_gc)
write.table(corr_chr_length, "tables/corr_chr_length.table")
#barplots repeat density per class and chr_type
y_axis_title="Density (counts per kb)"
X_axis_title="Genomic feature"
repeat_cl_bar_dens <- plot_repeat_class_bar(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat, rr_repeats_genes_long$density_var, rr_repeats_genes_long$chr_type)
#barplots repeat prop per class and chr_type
y_axis_title="Proportion"
X_axis_title="Genomic feature"
repeat_cl_bar_prop <- plot_repeat_class_bar(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat, rr_repeats_genes_long$prop_var, rr_repeats_genes_long$chr_type)
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean <- plot_repeat_class_bar(VAR_df_m,VAR_df_m$gen_feat,VAR_df_m$length_var/VAR_df_m$count_var,VAR_df_m$chr_type)
figure_repeat_bar_class <- ggarrange(repeat_cl_bar_prop, repeat_cl_bar_dens, repeat_cl_bar_mean,
labels = c("Figure X. A", "B", "C"), ncol = 3, nrow = 1,
common.legend = TRUE,
legend = "bottom")
figure_repeat_bar_class
#without genes (tot length)
VAR_df_m=rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="genes",]
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean <- plot_repeat_class_bar(VAR_df_m,VAR_df_m$gen_feat,VAR_df_m$length_var/VAR_df_m$count_var,VAR_df_m$chr_type)
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean <- plot_repeat_class_bar(VAR_df_m,VAR_df_m$gen_feat,VAR_df_m$length_var/VAR_df_m$count_var,VAR_df_m$chr_type)
#without genes (tot length)
VAR_df_m=rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="genes",]
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean2 <- plot_repeat_class_bar(VAR_df_m,VAR_df_m$gen_feat,VAR_df_m$length_var/VAR_df_m$count_var,VAR_df_m$chr_type)
figure_repeat_bar_class <- ggarrange(repeat_cl_bar_prop, repeat_cl_bar_dens, repeat_cl_bar_mean,repeat_cl_bar_mean2,
labels = c("Figure X. A", "B", "C", "D"), ncol = 2, nrow = 2,
common.legend = TRUE,
legend = "bottom")
repeat_cl_bar_mean
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
#barplots repeat length/repeat count per chr
VAR_df_m=rr_repeats_genes_long
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean <- plot_repeat_class_bar(VAR_df_m,VAR_df_m$gen_feat,VAR_df_m$length_var/VAR_df_m$count_var,VAR_df_m$chr_type)
#without genes (tot length)
VAR_df_x=rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="genes",]
y_axis_title="Mean length per repeat"
X_axis_title="Repeat class"
repeat_cl_bar_mean2 <- plot_repeat_class_bar(VAR_df_x,VAR_df_x$gen_feat,VAR_df_x$length_var/VAR_df_x$count_var,VAR_df_x$chr_type)
figure_repeat_bar_class <- ggarrange(repeat_cl_bar_prop, repeat_cl_bar_dens, repeat_cl_bar_mean,repeat_cl_bar_mean2,
labels = c("Figure X. A", "B", "C", "D"), ncol = 2, nrow = 2,
common.legend = TRUE,
legend = "bottom")
figure_repeat_bar_class
#function definition
plot_regional_distribution <- function(VAR_df, VAR){
ggplot(VAR_df, aes(sqrt((rel_pos-0.5)^2), VAR)) +
geom_point(aes(colour=chr_type, fill=chr_type),size=1, shape=21) +
geom_smooth(method="loess", colour=col_VAR, fill=col_VAR) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
#facet_wrap(~chrom, scales = "free_x") +
#scale_x_continuous(breaks = seq(1,max(rr_repeats$begin), 2000000)) +
ylab(y_axis_title) +
xlab("Chromosome position") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
axis.ticks = element_line(size = 0.2, colour = "grey"),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = "bottom") #+
}
#def variables
#rec rate
y_axis_title <- "Recombination rate (cM/Mb)"
col_VAR="dark grey"
regional_rr <- plot_regional_distribution(rr_repeats_genes_long, rr_repeats_genes_long$rec_rate)
#GC-content
y_axis_title <- "GC-content (%)"
#col_VAR="grey"
regional_gc <- plot_regional_distribution(rr_repeats_genes_long, rr_repeats_genes_long$GC)
#total repeat density
y_axis_title <- "Repeat density (counts per kb)"
#col_VAR=col_repeats
regional_rpt_dens <- plot_regional_distribution(subset(rr_repeats_genes_long, gen_feat=="rpt"), subset(rr_repeats_genes_long, gen_feat=="rpt")$density_var)
#total repeat proportion
y_axis_title <- "Repeat proportion"
#col_VAR=col_repeats
regional_rpt_prop <- plot_regional_distribution(subset(rr_repeats_genes_long, gen_feat=="rpt"), subset(rr_repeats_genes_long, gen_feat=="rpt")$prop_var)
#gene density
y_axis_title <- "Gene density (counts per kb)"
#col_VAR=col_gene
regional_gene_dens <- plot_regional_distribution(subset(rr_repeats_genes_long, gen_feat=="genes"), subset(rr_repeats_genes_long, gen_feat=="genes")$density_var)
#gene proportion
y_axis_title <- "Gene proportion (CDS)"
#col_VAR=col_gene
regional_gene_prop <- plot_regional_distribution(subset(rr_repeats_genes_long, gen_feat=="CDS"), subset(rr_repeats_genes_long, gen_feat=="CDS")$prop_var)
figure_regional_distr <- ggarrange(regional_rr + rremove("x.title"), regional_gc + rremove("x.title"), regional_rpt_dens + rremove("x.title"),regional_rpt_prop + rremove("x.title"), regional_gene_dens, regional_gene_prop,
labels = c("Figure X. A", "B", "C", "D","E", "F"), ncol = 2, nrow = 3,
common.legend = TRUE,
legend = "bottom")
figure_regional_distr
#Linear correlation
repeat_vs_gene_density <-
ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type != "W"), method = "lm", colour=col_repeats, fill=col_repeats) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#Linear correlation
repeat_vs_gene_density <-
ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_proportion <-
ggplot(rr_repeats_genes_wide, aes(prop_rpt, prop_genes)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat proportion") +
ylab("Gene proportion") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
ggarrange(repeat_vs_gene_density,repeat_vs_gene_proportion)
ggarrange(repeat_vs_gene_density,repeat_vs_gene_proportion, nrow = 2, ncol = 1, common.legend = T, legend = "right")
ggarrange(repeat_vs_gene_density,repeat_vs_gene_proportion, nrow = 2, ncol = 1, common.legend = T, legend = "right")
repeat_vs_gene_proportion <-
ggplot(rr_repeats_genes_wide, aes(prop_rpt, prop_CDS)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat proportion") +
ylab("Gene proportion (CDS)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
ggarrange(repeat_vs_gene_density,repeat_vs_gene_proportion, nrow = 2, ncol = 1, common.legend = T, legend = "right")
#rec_rate vs genomic feature
#GC
corr_rr_gc <-
ggplot(rr_repeats_genes_long, aes(GC*100, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#density
corr_dens_rr <-
ggplot(rr_repeats_genes_long, aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Proportion") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_plot <- ggarrange(corr_rr_gc, corr_dens_rr, corr_prop_rr,
ncol = 1, nrow = 3,
common.legend = T, legend = "right")
corr_rr_plot
corr_rr_CDS <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_CDS
corr_rr_CDS <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_CDS
corr_rr_CDS <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_CDS
corr_rr_rpt <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt
corr_rr_rpt <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt
corr_rr_rpt <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 3, nrow = 1,
common.legend = T, legend = "bottom")
corr_rr_CDS_dens <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 3, nrow = 1,
common.legend = T, legend = "bottom")
corr_rr_plot
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 1, nrow = 3,
common.legend = T, legend = "right")
corr_rr_plot
#multiplots
#density
corr_dens_rr <-
ggplot(rr_repeats_genes_long, aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Proportion") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_prop_rr
corr_dens_rr
rr_repeats_genes_wide <- as.data.frame(rr_repeats_genes_wide)
rr_repeats_genes_wide_sc <- cbind(rr_repeats_genes_wide[,c("chrom", "chr_type", "rec_rate")], scale(rr_repeats_genes_wide$chr_length), scale(rr_repeats_genes_wide$GC), scale(select(rr_repeats_genes_wide, starts_with("density_"))), scale(select(rr_repeats_genes_wide, starts_with("prop_"))))
rr_repeats_genes_wide_sc
colnames(rr_repeats_genes_wide_sc)[4] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[5] <- "GC"
rr_repeats_genes_wide_sc$rel_pos <- rr_repeats_genes_wide$rel_pos
#with GC
mod4_sc <- glm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$rel_pos + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc)
mod4_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$rel_pos + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc_lm)
#without W
rr_repeats_genes_wide_sc_noW <- rr_repeats_genes_wide_sc[rr_repeats_genes_wide_sc$chr_type!="W",]
#noW
mmod1_incl_pos_gc_noW <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc_noW)
library(lme4)
#noW
mmod1_incl_pos_gc_noW <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc_noW)
summary(mmod1_incl_pos_gc_noW)
mmod1_incl_pos_gc <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1_incl_pos_gc)
