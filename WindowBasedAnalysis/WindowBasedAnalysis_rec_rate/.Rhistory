scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt
corr_rr_rpt <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 3, nrow = 1,
common.legend = T, legend = "bottom")
corr_rr_CDS_dens <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS" & chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
#facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 3, nrow = 1,
common.legend = T, legend = "bottom")
corr_rr_plot
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens,
ncol = 1, nrow = 3,
common.legend = T, legend = "right")
corr_rr_plot
#multiplots
#density
corr_dens_rr <-
ggplot(rr_repeats_genes_long, aes(density_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_W, fill=col_W) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type != "W"), method = "lm", colour=col_autosome, fill=col_autosome) +
facet_wrap(~gen_feat, scales = "free") +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Proportion") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_prop_rr
corr_dens_rr
rr_repeats_genes_wide <- as.data.frame(rr_repeats_genes_wide)
rr_repeats_genes_wide_sc <- cbind(rr_repeats_genes_wide[,c("chrom", "chr_type", "rec_rate")], scale(rr_repeats_genes_wide$chr_length), scale(rr_repeats_genes_wide$GC), scale(select(rr_repeats_genes_wide, starts_with("density_"))), scale(select(rr_repeats_genes_wide, starts_with("prop_"))))
rr_repeats_genes_wide_sc
colnames(rr_repeats_genes_wide_sc)[4] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[5] <- "GC"
rr_repeats_genes_wide_sc$rel_pos <- rr_repeats_genes_wide$rel_pos
#with GC
mod4_sc <- glm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$rel_pos + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc)
mod4_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$rel_pos + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc_lm)
#without W
rr_repeats_genes_wide_sc_noW <- rr_repeats_genes_wide_sc[rr_repeats_genes_wide_sc$chr_type!="W",]
#noW
mmod1_incl_pos_gc_noW <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc_noW)
library(lme4)
#noW
mmod1_incl_pos_gc_noW <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc_noW)
summary(mmod1_incl_pos_gc_noW)
mmod1_incl_pos_gc <- lmer(rec_rate~chr_length + (1|chr_type) + rel_pos + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1_incl_pos_gc)
knitr::opts_chunk$set(echo = TRUE)
rec_rate <- read.table("tables/rec_rate_markers.table", header = T)
rec_rate$pos_group <- cut(sqrt((rec_rate$rel_pos-50)^2), c(-Inf,10,20,30,40,Inf), c(1,2,3,4,5))
pairwise.t.test(rec_rate$slidingwindow.3, rec_rate$pos_group, )
#library(MareyMap)
library(ggplot2)
library(viridis)
library("tidyr")
library(plyr)
library(dplyr)
#startMareyMapGUI()
knitr::opts_chunk$set(echo = TRUE)
#install.packages("ggpubr")
library(ggplot2)
library(ggpubr)
library(viridis)
library("tidyr")
library(plyr)
library(dplyr)
library(data.table)
#read in the merged and cleaned table
rr_repeats_window <- read.csv("tables/rec_rate_2Mb_windows_vs_repeats_clean.csv", sep = ";")
str(rr_repeats_window)
summary(rr_repeats_window)
#rr_repeats_window[,c(4:17)][is.na(rr_repeats_window[,c(4:17)])] <- 0
rr_repeats_window$GC <- read.table("window_based_data/GCA_905220365.1_ilVanCard2.1_genomic_chroms.2MB.GC.tsv")[,5]
gene_dens <- read.table("window_based_data/gene_density_2Mb_doublQC.tsv", header = T, fill = TRUE)
colnames(gene_dens)[1] <- "chrom"
#change NA to 0 (count or length are 0)
gene_dens[is.na(gene_dens)] <- 0
str(gene_dens)
gene_dens_CDS <- read.table("window_based_data/gene_CDS_2Mb_doublQC.tsv", header = T, fill = TRUE)
gene_dens_CDS[is.na(gene_dens_CDS)] <- 0
str(gene_dens_CDS)
gene_dens$count_CDS <- gene_dens$count_genes
gene_dens$length_CDS <- gene_dens_CDS$CDS_length
rr_repeats_genes <- join(rr_repeats_window, gene_dens, type = "inner")
rr_repeats_genes$chr_type <- "Autosome"
rr_repeats_genes$chr_type[rr_repeats_genes$chrom=="LR999924.1"] <- "Z"
rr_repeats_genes$chr_type[rr_repeats_genes$chrom=="LR999940.1"] <- "W"
str(rr_repeats_genes)
rr_repeats_genes$length_genes <- as.integer(rr_repeats_genes$length_genes)
rr_repeats_genes$length_CDS <- as.integer(rr_repeats_genes$length_CDS)
#select columns based on string
#select(rr_repeats_window, starts_with("length"))
#or colnames(rr_repeats_genes[, grepl("length_", colnames(rr_repeats_genes))])
#long format
# rr_repeats_genes_long <- pivot_longer(rr_repeats_genes, select(rr_repeats_genes, starts_with("length")), names_to = "repeat_class", values_to = "proportion")
# str(rr_repeats_genes_long)
# rr_repeats_genes_long <- melt(setDT(rr_repeats_genes), measure.vars = list(names(select(rr_repeats_genes, starts_with("count"))),names(select(rr_repeats_genes, starts_with("length")))), variable.name = "gen_feat", value.name = c("count_var", "length_var"))
rr_repeats_genes_long <- melt(setDT(rr_repeats_genes), measure = patterns("count_", "length_"), variable.name = "gen_feat", value.name = c("count_var", "length_var"))
str(rr_repeats_genes_long)
levels(rr_repeats_genes_long$gen_feat) <- names(select(rr_repeats_genes, starts_with("length"))) %>% stringr::str_remove(".+_")
str(rr_repeats_genes_long)
#get density of repeats per kilobase: count*1000/sequence length
rr_repeats_genes_long$density_var <- rr_repeats_genes_long$count_var*1000/(rr_repeats_genes_long$end-rr_repeats_genes_long$begin+1)
#get proportion of genomic features per base: length/sequence length
rr_repeats_genes_long$prop_var <- rr_repeats_genes_long$length_var/(rr_repeats_genes_long$end-rr_repeats_genes_long$begin+1)
#relative position (begin + end)/2 (in the middle of the window)
rr_repeats_genes_long$rel_pos <- ((rr_repeats_genes_long$begin+rr_repeats_genes_long$end)/2)/rr_repeats_genes_long$chr_length
str(rr_repeats_genes_long)
#get wide format for
rr_repeats_genes_wide <- pivot_wider(rr_repeats_genes_long, names_from = gen_feat, values_from = c(count_var, length_var, density_var, prop_var))
colnames(rr_repeats_genes_wide) <- gsub("_var", "", colnames(rr_repeats_genes_wide))
str(rr_repeats_genes_wide)
rr_repeats_genes_long$pos_group <- cut(sqrt((rr_repeats_genes_long$rel_pos-50)^2), c(-Inf,10,20,30,40,Inf), c(1,2,3,4,5))
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group)
summary(rr_repeats_genes_long)
rr_repeats_genes_long$pos_group <- cut(sqrt((rr_repeats_genes_long$rel_pos-0.50)^2), c(-Inf,10,20,30,40,Inf), c(1,2,3,4,5))
summary(rr_repeats_genes_long)
rr_repeats_genes_long$rel_pos-0.50
rr_repeats_genes_long$pos_group <- cut(sqrt(((rr_repeats_genes_long$rel_pos*100)-50)^2), c(-Inf,10,20,30,40,Inf), c(1,2,3,4,5))
summary(rr_repeats_genes_long)
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group)
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "FDR")
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "fdr")
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "BH")
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "none")
pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "holm")
pos_groups_test <- pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "holm")
pos_groups_test <- pairwise.t.test(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, p.adjust.method = "holm")
capture.output(pos_groups_test, file = "result_regioanl_pos_pairwise_t_test.txt")
boxplot(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group)
boxplot(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group)
boxplot(rr_repeats_genes_long$rec_rate~rr_repeats_genes_long$pos_group)
lm_groups <- lm(rr_repeats_genes_long$rec_rate~rr_repeats_genes_long$pos_group + rr_repeats_genes_long$chr_length)
anova(lm_groups)
summary(lm_groups)
lm_groups <- lm(rr_repeats_genes_long$rec_rate~rr_repeats_genes_long$pos_group + rr_repeats_genes_long$chr_length + rr_repeats_genes_long$density_var)
anova(lm_groups)
summary(lm_groups)
lm_groups <- lm(rr_repeats_genes_long$rec_rate~rr_repeats_genes_long$pos_group + rr_repeats_genes_long$chr_length + rr_repeats_genes_long$chr_type)
summary(lm_groups)
mod1 <- glm(rr_repeats_genes_wide$rec_rate~rr_repeats_genes_wide$chr_length + rr_repeats_genes_wide$density_SINE + rr_repeats_genes_wide$density_DNA + rr_repeats_genes_wide$density_TcM + rr_repeats_genes_wide$density_LINE + rr_repeats_genes_wide$density_LTR + rr_repeats_genes_wide$density_nonLTR + rr_repeats_genes_wide$density_genes)
summary(mod1)
lm_groups <- lm(rr_repeats_genes_wide$rec_rate~rr_repeats_genes_wide$pos_group + rr_repeats_genes_wide$chr_length + rr_repeats_genes_wide$chr_type)
#get wide format for
rr_repeats_genes_wide <- pivot_wider(rr_repeats_genes_long, names_from = gen_feat, values_from = c(count_var, length_var, density_var, prop_var))
colnames(rr_repeats_genes_wide) <- gsub("_var", "", colnames(rr_repeats_genes_wide))
str(rr_repeats_genes_wide)
lm_groups <- lm(rr_repeats_genes_wide$rec_rate~rr_repeats_genes_wide$pos_group + rr_repeats_genes_wide$chr_length + rr_repeats_genes_wide$chr_type)
anova(lm_groups)
summary(lm_groups)
mod1 <- lm(rr_repeats_genes_wide$rec_rate~rr_repeats_genes_wide$chr_length + rr_repeats_genes_wide$pos_group + rr_repeats_genes_wide$chr_type + rr_repeats_genes_wide$density_SINE + rr_repeats_genes_wide$density_DNA + rr_repeats_genes_wide$density_TcM + rr_repeats_genes_wide$density_LINE + rr_repeats_genes_wide$density_LTR + rr_repeats_genes_wide$density_nonLTR + rr_repeats_genes_wide$density_genes)
summary(mod1)
mod1 <- glm(rr_repeats_genes_wide$rec_rate~rr_repeats_genes_wide$chr_length + rr_repeats_genes_wide$pos_group + rr_repeats_genes_wide$chr_type + rr_repeats_genes_wide$density_SINE + rr_repeats_genes_wide$density_DNA + rr_repeats_genes_wide$density_TcM + rr_repeats_genes_wide$density_LINE + rr_repeats_genes_wide$density_LTR + rr_repeats_genes_wide$density_nonLTR + rr_repeats_genes_wide$density_genes)
summary(mod1)
anova(mod1)
mod1
capture.output(pos_groups_test, file = "result_regional_pos_pairwise_t_test.txt")
rr_repeats_genes_wide <- as.data.frame(rr_repeats_genes_wide)
rr_repeats_genes_wide_sc <- cbind(rr_repeats_genes_wide[,c("chrom", "chr_type", "rec_rate", "pos_group")], scale(rr_repeats_genes_wide$chr_length), scale(rr_repeats_genes_wide$GC), scale(select(rr_repeats_genes_wide, starts_with("density_"))), scale(select(rr_repeats_genes_wide, starts_with("prop_"))))
colnames(rr_repeats_genes_wide_sc)[4] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)
rr_repeats_genes_wide_sc <- cbind(rr_repeats_genes_wide[,c("chrom", "chr_type", "rec_rate", "pos_group")], scale(rr_repeats_genes_wide$chr_length), scale(rr_repeats_genes_wide$GC), scale(select(rr_repeats_genes_wide, starts_with("density_"))), scale(select(rr_repeats_genes_wide, starts_with("prop_"))))
colnames(rr_repeats_genes_wide_sc)["scale(rr_repeats_genes_wide$chr_length)"] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[5] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[5] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[5] <- "chr_length"
colnames(rr_repeats_genes_wide_sc)[6] <- "GC"
mod3_sc <- glm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$density_genes)
summary(mod3_sc)
library(lme4)
mmod1 <- lmer(rec_rate~chr_length + (1|chr_type) + pos_group + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1)
print(mmod1, correlation=T)
#lm
mod4_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc_lm)
#with GC
#glm
mod4_sc <- glm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$rel_pos + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
#with GC
#glm
mod4_sc <- glm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod4_sc)
plot(mod_sc_lm)
#lm
mod_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_genes + rr_repeats_genes_wide_sc$density_genes)
summary(mod_sc_lm)
plot(mod_sc_lm)
mmod1 <- lmer(rec_rate~chr_length + (1|chr_type) + pos_group + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
mmod2 <- lmer(rec_rate~(1|chr_length) + (1|chr_type) + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1)
anova(mmod1)
confint(mmod1)
confint(mod_sc_lm)
plot(mod_sc_lm)
#lm
mod_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$prop_CDS + rr_repeats_genes_wide_sc$density_genes)
summary(mod_sc_lm)
confint(mod_sc_lm)
plot(mod_sc_lm)
#lm
mod_sc_lm <- lm(rr_repeats_genes_wide_sc$rec_rate~rr_repeats_genes_wide_sc$chr_length + rr_repeats_genes_wide_sc$chr_type + rr_repeats_genes_wide_sc$pos_group + rr_repeats_genes_wide_sc$GC + rr_repeats_genes_wide_sc$density_SINE + rr_repeats_genes_wide_sc$density_DNA + rr_repeats_genes_wide_sc$density_TcM + rr_repeats_genes_wide_sc$density_LINE + rr_repeats_genes_wide_sc$density_LTR + rr_repeats_genes_wide_sc$density_nonLTR + rr_repeats_genes_wide_sc$density_genes)
summary(mod_sc_lm)
capture.output(summary(mod_sc_lm), file = "tables/lm_model.txt")
confint(mod_sc_lm)
capture.output(confint(mod_sc_lm), file = "tables/lm_model.txt", append = T)
plot(mod_sc_lm)
mmod1 <- lmer(rec_rate~chr_length + (1|chr_type) + pos_group + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1)
capture.output(summary(mmod1), file = "tables/lmer_mixmodel.txt")
confint(mmod1)
capture.output(confint(mmod1), file = "tables/lmer_mixmodel.txt", append = T)
print(mmod1$value, correlation=TRUE)
vcov(mmod1)
print(mmod1, correlation=TRUE)
plot(rr_repeats_genes_long$GC, rr_repeats_genes_long$pos_group)
cor.test(rr_repeats_genes_long$GC, rr_repeats_genes_long$pos_group)
cor.test(rr_repeats_genes_long$GC, rr_repeats_genes_long$rel_pos)
vcov(rr_repeats_genes_long)
print(rr_repeats_genes_long, correlation=TRUE)
vcov(rr_repeats_genes_wide)
vcov(as.matrix(rr_repeats_genes_wide))
vcov(lm(rr_repeats_genes_wide))
mmod1
str(mmod1)
mmod1 <- lmer(rec_rate~chr_length + (1|chr_type) + pos_group + GC + density_SINE + density_DNA + density_TcM + density_LINE + density_LTR + density_nonLTR + density_genes, rr_repeats_genes_wide_sc)
summary(mmod1)
capture.output(summary(mmod1), file = "tables/lmer_mixmodel.txt")
confint(mmod1)
capture.output(confint(mmod1), file = "tables/lmer_mixmodel.txt", append = T)
#function definition
plot_regional_distribution <- function(VAR_df, VAR){
ggplot(VAR_df, aes(sqrt((rel_pos-0.5)^2), VAR)) +
geom_point(aes(colour=chr_type, fill=chr_type),size=1, shape=21) +
geom_smooth(method="loess", colour=col_VAR, fill=col_VAR) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
#facet_wrap(~chrom, scales = "free_x") +
#scale_x_continuous(breaks = seq(1,max(rr_repeats$begin), 2000000)) +
ylab(y_axis_title) +
xlab("Chromosome position") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
axis.ticks = element_line(size = 0.2, colour = "grey"),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = "bottom") #+
}
#def variables
#rec rate
y_axis_title <- "Recombination rate (cM/Mb)"
#how to run the function: plot_chr_level(VAR)
#assign colour variables
col_Z <- "#009294"   #"#005F60"
col_W <- "#FAAB36"
col_autosome <- "grey"
#def variables
#rec rate
y_axis_title <- "Recombination rate (cM/Mb)"
col_VAR="dark grey"
regional_rr <- plot_regional_distribution(rr_repeats_genes_long, rr_repeats_genes_long$rec_rate)
regional_rr
#function definition
plot_chr_level <- function(VAR){
VAR_mean <- aggregate(VAR, by=list(VAR_df$chrom), mean, na.rm=T)
VAR_sd <- aggregate(VAR, by=list(VAR_df$chrom), sd, na.rm=T)
ggplot(VAR_mean, aes(unique(rr_repeats_genes_long$chr_length)/1000000, VAR_mean$x)) +
geom_smooth(method = "lm", colour=VAR_colour, fill=VAR_colour) +
geom_pointrange(aes(ymin=VAR_mean$x-VAR_sd$x, ymax=VAR_mean$x+VAR_sd$x), size=0.2) +
geom_point(aes(fill=unique(rr_repeats_genes_long[,c("chrom","chr_type")])$chr_type), size=3, shape=21, colour="black") +
ylab(y_axis_title) +
xlab(x_axis_title) +
#scale_colour_discrete(type = c("black", col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = c(0.8,0.8),
axis.ticks = element_line(size = 0.2, colour = "grey")) #+
}
#function definition
plot_regional_distribution <- function(VAR_df, VAR){
ggplot(VAR_df, aes(sqrt((rel_pos-0.5)^2), VAR)) +
geom_point(aes(colour=chr_type, fill=chr_type),size=1, shape=21, colour="black") +
geom_smooth(method="loess", colour=col_VAR, fill=col_VAR) +
#scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
#facet_wrap(~chrom, scales = "free_x") +
#scale_x_continuous(breaks = seq(1,max(rr_repeats$begin), 2000000)) +
ylab(y_axis_title) +
xlab("Chromosome position") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
axis.ticks = element_line(size = 0.2, colour = "grey"),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = "bottom") #+
}
regional_rr <- plot_regional_distribution(rr_repeats_genes_long, rr_repeats_genes_long$rec_rate)
regional_rr
#function definition
plot_regional_distribution <- function(VAR_df, VAR){
ggplot(VAR_df, aes(sqrt((rel_pos-0.5)^2), VAR)) +
geom_point(aes(colour=chr_type, fill=chr_type),size=1, shape=21, colour="black", stroke=0.1) +
geom_smooth(method="loess", colour=col_VAR, fill=col_VAR) +
#scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
#facet_wrap(~chrom, scales = "free_x") +
#scale_x_continuous(breaks = seq(1,max(rr_repeats$begin), 2000000)) +
ylab(y_axis_title) +
xlab("Chromosome position") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
axis.ticks = element_line(size = 0.2, colour = "grey"),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = "bottom") #+
}
regional_rr <- plot_regional_distribution(rr_repeats_genes_long, rr_repeats_genes_long$rec_rate)
regional_rr
regional_rr +
geom_boxplot(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate)
regional_rr +
geom_boxplot(aes(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate))
ggplot(rr_repeats_genes_long) +
geom_boxplot(aes(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate))
regional_rr +
geom_boxplot(aes(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate), fill="white", colour="grey") +
#GC-content
y_axis_title <- "GC-content (%)"
regional_rr +
geom_boxplot(aes(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate), fill="white", colour="grey")
regional_rr +
geom_boxplot(aes(rr_repeats_genes_long$pos_group, rr_repeats_genes_long$rec_rate, fill="white", colour="grey"))
regional_rr
aggregate(rr_repeats_genes_long$rec_rate, rr_repeats_genes_long$pos_group, mean)
aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean)
aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, rm.na=T)
aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)
aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x
regional_rr +
geom_errorbar(aes(x=(pos_group/100)-5,
ymin=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x-aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x,
ymax=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x+aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x),
colour="black", width=.1, position=pd)
regional_rr +
geom_errorbar(aes(x=(pos_group/100)-5,
ymin=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x-aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x,
ymax=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x+aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x),
colour="black", width=.1)
regional_rr +
geom_errorbar(aes(x=c(0.05, 0.15, 0.25, 0.35, 0.45),
ymin=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x-aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x,
ymax=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x+aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x),
colour="black", width=.1)
regional_rr +
geom_errorbar(aes(x=(as.numeric(rr_repeats_genes_long$pos_group)/100)-0.5,
ymin=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x-aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x,
ymax=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x+aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x),
colour="black", width=.1)
regional_rr +
geom_errorbar(aes(x=(as.numeric(unique(rr_repeats_genes_long$pos_group))/100)-0.5,
ymin=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x-aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x,
ymax=aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)$x+aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x),
colour="black", width=.1)
mean_rr_pos <- aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), mean, na.rm=T)
mean_rr_pos$sd <- aggregate(rr_repeats_genes_long$rec_rate, by=list(rr_repeats_genes_long$pos_group), sd, na.rm=T)$x
mean_rr_pos
regional_rr +
geom_errorbar(mean_rr_pos, aes(x=(as.numeric(Group.1)/100)-0.5,
ymin=xsd, ymax=x+sd),
colour="black", width=.1)
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/100)-0.5,
ymin=x-sd, ymax=x+sd),
colour="black", width=.1)
(as.numeric(Group.1)/100)-0.5
(as.numeric(mean_rr_pos$Group.1)/100)-0.5
(as.numeric(mean_rr_pos$Group.1)
as.numeric(mean_rr_pos$Group.1)
as.numeric(mean_rr_pos$Group.1)
as.numeric(mean_rr_pos$Group.1)/10
(as.numeric(mean_rr_pos$Group.1)/10)-0.05
mean_rr_pos
mean_rr_pos$x
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(mean_rr_pos$Group.1)/10)-0.05,
ymin=x-sd, ymax=x+sd),
colour="black", width=.1)
ymin=mean_rr_pos$x-mean_rrsd
ymin=mean_rr_pos$x-mean_rr_pos$sd
ymin
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05,
ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.1)
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=mean, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.1)
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.1)
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.01,)
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.01,) +
geom_point(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x))
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.01,) +
geom_point(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x), shape=21, fill="white", colour="dark grey")
regional_rr +
geom_errorbar(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x, ymin=mean_rr_pos$x-mean_rr_pos$sd, ymax=mean_rr_pos$x+mean_rr_pos$sd),
colour="black", width=.01,) +
geom_point(data=mean_rr_pos, aes(x=(as.numeric(Group.1)/10)-0.05, y=x), size=3, shape=21, fill="white", colour="dark grey")
knitr::opts_chunk$set(echo = TRUE)
#install.packages("ggpubr")
library(ggplot2)
library(ggpubr)
library(viridis)
library("tidyr")
library(plyr)
library(dplyr)
library(data.table)
multi_100kb.df <- read.table("../JointAnalysis/LR999924.1-counts-merged.tsv", header = T)
head(multi_100kb.df)
summary(multi_100kb.df)
tail(multi_100kb.df)
