axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
ggsave(gains_violin, file="plots/gains_violin.pdf", "pdf", width = 7, height = 3.5, dpi = 300)
ggsave(gains_violin, file="plots/gains_violin.jpeg", "jpeg", width = 7, height = 3.5, dpi = 300)
##4d3500", "#d19200"
gains_violin <- ggplot(counts_merged_100kb_long[counts_merged_100kb_long$gen_feat!=c("gene_ex"),],
aes(gen_feat, counts, fill=gene_ex_bin)) +
geom_split_violin(size=0.2) +
stat_summary(fun.y = mean, fun.ymin = mean, fun.ymax = mean,
geom = "crossbar",
width = 0.25,
position = position_dodge(width = .25), size = 0.2, show.legend = FALSE) +
scale_y_continuous(trans = "log10") +
scale_fill_discrete(type = c("#916400","#FAAB36"), labels = c("without gains", ">1 gaines")) +
xlab("") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
ggsave(gains_violin, file="plots/gains_violin.pdf", "pdf", width = 7, height = 3.5, dpi = 300)
ggsave(gains_violin, file="plots/gains_violin.jpeg", "jpeg", width = 7, height = 3.5, dpi = 300)
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb_long, aes(rpt, gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
levels(counts_merged_100kb_long$gen_feat)
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb_long, aes(rpt, gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb_long, aes(counts_merged_100kb_long$rpt, counts_merged_100kb_long$gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
ggplot(counts_merged_100kb_long, aes(counts_merged_100kb_long$rpt, counts_merged_100kb_long$gene))
ggplot(counts_merged_100kb_long, aes(rpt, gene))
counts_merged_100kb
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb, aes(count_rpt, count_gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb, aes(count_rpt, count_gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
repeat_vs_gene_100kb <- ggplot(counts_merged_100kb, aes(count_rpt, count_gene)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(counts_merged_100kb, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat counts") +
ylab("Gene counts") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_100kb
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
geom_smooth(method = "lm", colour=col_all, fill=col_all) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(colour=chr_type, fill=chr_type),shape=21,size=1) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_colour_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
#rec_rate vs genomic feature
#setting x max to 38 no rows with rec rate where GC < 38
#GC
corr_rr_gc <-
ggplot(rr_repeats_genes_long, aes(GC*100, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(min(rr_repeats_genes_long$GC)*100, 38)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_rpt <-     ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt"), aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(0.5, max(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="rpt")$density_var))) +
xlab("Repeat density (counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_CDS_dens <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(0, 0.075)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_gains <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="gains"), aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(0, max(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="gains")$density_var))) +
xlab("Gene gains") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens, corr_rr_gains,
ncol = 2, nrow = 2,
common.legend = T, legend = "right")
corr_rr_plot
ggsave(corr_rr_plot, file="plots_supplement/corr_rr_plot.pdf", "pdf", dpi = 300)
ggsave(corr_rr_plot, file="plots_supplement/corr_rr_plot.jpeg", "jpeg", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=1, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=2, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
#rec_rate vs genomic feature
#setting x max to 38 no rows with rec rate where GC < 38
#GC
corr_rr_gc <-
ggplot(rr_repeats_genes_long, aes(GC*100, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(min(rr_repeats_genes_long$GC)*100, 38)) +
xlab("GC-content (%)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_CDS_dens <-
ggplot(subset(rr_repeats_genes_long, rr_repeats_genes_long$gen_feat=="CDS"), aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=2, stroke=0.2) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
#facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
scale_x_continuous(limits = c(0, 0.075)) +
xlab("Gene density") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.ticks = element_line(size = 0.25),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_rr_plot <- ggarrange(corr_rr_gc, corr_rr_rpt, corr_rr_CDS_dens, corr_rr_gains,
ncol = 2, nrow = 2,
common.legend = T, legend = "right")
corr_rr_plot
ggsave(corr_rr_plot, file="plots_supplement/corr_rr_plot.pdf", "pdf", dpi = 300)
ggsave(corr_rr_plot, file="plots_supplement/corr_rr_plot.jpeg", "jpeg", dpi = 300)
#multiplots
#density
corr_dens_rr <-
ggplot(rr_repeats_genes_long, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_prop_rr
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_prop_rr
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.pdf", "pdf", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.pdf", "pdf", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.jpeg", "jpeg", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.pdf", "pdf", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.jpeg", "jpeg", dpi = 300)
ggsave(corr_dens_rr, file="plots_supplement/corr_dens_rr.pdf", "pdf", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.pdf", "pdf", dpi = 300)
ggsave(corr_prop_rr, file="plots_supplement/corr_prop_rr.jpeg", "jpeg", dpi = 300)
ggsave(corr_dens_rr, file="plots_supplement/corr_dens_rr.pdf", "pdf", dpi = 300)
ggsave(corr_dens_rr, file="plots_supplement/corr_dens_rr.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=3, stroke=0.2, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=3, stroke=0.2, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=3, stroke=0.3, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
