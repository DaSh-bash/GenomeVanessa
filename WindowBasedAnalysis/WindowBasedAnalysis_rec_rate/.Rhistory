xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
repeat_vs_gene_density_2Mb <- ggplot(rr_repeats_genes_wide, aes(density_rpt, density_genes)) +
geom_point(aes(fill=chr_type),shape=21,size=3, stroke=0.3, colour = col_all) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_wide, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, se=F) +
#geom_label(x=0.0012, y=14, label="Cor.coeff=0.341,   \n p-value=4.057e-07", size=3) +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
xlab("Repeat density (Counts per kb)") +
ylab("Gene density (Counts per kb)") +
guides(size = "none") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.25, colour = "gray"),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.25),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
repeat_vs_gene_density_2Mb
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.pdf", "pdf", dpi = 300)
ggsave(repeat_vs_gene_density_2Mb, file="plots/repeat_vs_gene_density.jpeg", "jpeg", dpi = 300)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("ggpubr")
library(ggplot2)
library(ggpubr)
library(viridis)
library("tidyr")
library(plyr)
library(dplyr)
library(data.table)
library(rstatix)
library(lme4)
col_Z <- "#009294"   #"#005F60"
col_W <- "#FAAB36"
col_autosome <- "grey"
col_all <- "#424242" #very dark grey
rr_repeats_genes_long <- read.table("tables/rec_rate_vs_repeats_genes_2Mb_windows_long.table")
#multiplots
#density
corr_dens_rr <-
ggplot(rr_repeats_genes_long, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr
levels(rr_repeats_genes_long$gen_feat)
str(rr_repeats_genes_long)
head(rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!=c("CDS", "gains", "TcM"),])
length(rr_repeats_genes_long$chrom)
length(rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!=c("CDS", "gains", "TcM"),1])
#density without CDS
corr_dens_rr_red <-
ggplot(rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!=c("CDS", "gains", "TcM"),], aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!=c("CDS", "gains", "TcM"),]
str(data_reduced)
unique(data_reduced$gen_feat)
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS",]
unique(data_reduced$gen_feat)
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS" && rr_repeats_genes_long$gen_feat!="gains",]
unique(data_reduced$gen_feat)
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS" & rr_repeats_genes_long$gen_feat!="gains",]
unique(data_reduced$gen_feat)
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS" & rr_repeats_genes_long$gen_feat!="gains" & rr_repeats_genes_long$gen_feat!="TcM",]
unique(data_reduced$gen_feat)
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
# "rpt"    "SINE"   "DNA"    "TcM"    "LINE"   "LTR"    "nonLTR" "genes"  "CDS"    "gains"  "simple"
rr_repeats_genes_long$gen_feat <-  factor(rr_repeats_genes_long$gen_feat, levels = c("genes", "CDS", "gains", "rpt", "LINE", "SINE", "nonLTR", "LTR", "DNA", "TcM", "simple"))
write.table(rr_repeats_genes_long, file="tables/rec_rate_vs_repeats_genes_2Mb_windows_long.table")
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS" & rr_repeats_genes_long$gen_feat!="gains" & rr_repeats_genes_long$gen_feat!="TcM",]
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph="line") +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_vline) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element(),
legend.title = element_blank())
version(ggplot())
ggplot()
ggplot(version)
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_abline) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element(),
legend.title = element_blank())
#proportion
corr_prop_rr <-
ggplot(rr_repeats_genes_long, aes(prop_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_abline()) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(rr_repeats_genes_long, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Occupied length") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_vline) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_abline) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_hline) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect(size = c(3,1))) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect(chr_type, size = c(3,1))) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect(data_reduced$chr_type, size = c(3,1))) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect(as_factor(data_reduced$chr_type), size = c(3,1))) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect(as.data.frame.factor(data_reduced$chr_type), size = c(3,1))) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
data_reduced <- rr_repeats_genes_long[rr_repeats_genes_long$gen_feat!="CDS" & rr_repeats_genes_long$gen_feat!="gains",]
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z)) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z), labels=c("Autosomes","W-chromosome","Z-chromosome")) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
corr_dens_rr_red
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z, coll_all), labels=c("Autosomes","W-chromosome","Z-chromosome", "All chromosomes")) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
corr_dens_rr_red <-
ggplot(data_reduced, aes(density_var, rec_rate)) +
geom_point(aes(fill=chr_type),shape=21,size=1, stroke=0.1, key_glyph=draw_key_rect) +
geom_smooth(method = "lm", colour=col_all, fill=col_all, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "W"), method = "lm", colour=col_W, fill=col_W, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Z"), method = "lm", colour=col_Z, fill=col_Z, fullrange=T, se=F) +
geom_smooth(data=subset(data_reduced, chr_type == "Autosome"), method = "lm", colour=col_autosome, fill=col_autosome, fullrange=T, se=F) +
facet_wrap(~gen_feat, scales = "free") +
scale_fill_discrete(type = c(col_autosome, col_W, col_Z, col_all), labels=c("Autosomes","W-chromosome","Z-chromosome", "All chromosomes")) +
scale_y_continuous(limits = c(0,16)) +
xlab("Density (Counts per kb)") +
ylab("Recombination rate (cM/Mb)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "gray"),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
corr_dens_rr_red
corr_dens_rr_red
