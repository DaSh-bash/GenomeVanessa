#24 expanded orthogroups sp_gains_bestmodel.txt 
#255 sp_gains_bestmodel.txt_genenames.txt (nr of genes)

join sp_gains_bestmodel.txt_genenames.txt ../topGO/TopGO_Data_Prep/Vanessa_TopGo_reference_base_filtered.tsv | grep "GO" |awk '{print $1}' > sp_gains_bestmodel.txt_genenames.txt_with_GO_terms
grep -f sp_gains_bestmodel.txt_genenames.txt_with_GO_terms ../topGO/TopGO_Data_Prep/Orthogroups.tsv 

#removing manually 3 known OG repeats with the entire orthogroups (53 genes)
grep -f ../topGO/result_topGO/list_susp_genes_names_only.txt ../topGO/TopGO_Data_Prep/Orthogroups.tsv

#new file sp_gains_bestmodel_filtered.txt
#get gene names with the script gene_selector_mod.sh
sp_gains_bestmodel_filtered.txt_genenames.txt


#check gff
awk '$3=="mRNA"' ~/Documents/GitHub/GenomeVanessa/AnnotationV2/makerrun3.all.maker.rename.proteins.AED50.eAED50.long50.norepeatdomain.no1exon.nooverlap.noW.gff |grep -f data/sp_gains_bestmodel_filtered.txt_genenames.txt - |awk '{print $9}' |uniq -c |wc -l
161

#only 135 of 161 are annotated (with Go-term or "None" and only 34 have GO-terms (representing 8 orthogroups)

#get file with positions
awk '$3=="mRNA"' ~/Documents/GitHub/GenomeVanessa/AnnotationV2/makerrun3.all.maker.rename.proteins.AED50.eAED50.long50.norepeatdomain.no1exon.nooverlap.noW.gff |grep -f data/sp_gains_bestmodel_filtered.txt_genenames.txt - |cut -f1 -d ":" |awk '{print $1, $4, $5, $9 }' |sed 's/ID=//g' > gained_genes_position.table

##########
#after filtering out uncertain genes without putative functional annotation 
awk '{print $6}' Documents/GitHub/GenomeVanessa/WindowBasedAnalysis/rec_rate_WindowBasedAnalysis_220128/data/gained_genes_filtered_corr.txt |wc -l
77

#number of remaining orthogroups
awk '{print $6}' Documents/GitHub/GenomeVanessa/WindowBasedAnalysis/rec_rate_WindowBasedAnalysis_220128/data/gained_genes_filtered_corr.txt |sort |uniq |wc -l
      15


#################
#summary V. cardui
#################
77 genes in 15 orthogroups


##################
V cardui and Monarch

      41 spM_gains_bestmodel_both.txt

     115 spM_gains_bestmodel_both.txt_genenames.txt (nr of genes)

#removing one known repeat
grep -f ../topGO/result_topGO/list_susp_genes_names_only.txt spM_gains_bestmodel_both.txt_genenames.txt 
Vcard_DToL18102-RA

#belongs to OG0000001, three genes Vcard_DToL03608-RA, Vcard_DToL15240-RA, Vcard_DToL18102-RA

grep -f spM_gains_bestmodel_both.txt_genenames.txt_with_GO_terms ../topGO/TopGO_Data_Prep/Orthogroups.tsv

#check orthogroups if only vcard and dplex
grep -f ../Badirate_incl_topGO_220114/results/spM_gains_bestmodel_both_list_OG.txt ../Badirate_incl_topGO_220114/topGO/TopGO_Data_Prep/Orthogroups.tsv > ../Badirate_incl_topGO_220114/results/spM_gains_bestmodel_both_OG_genes.txt


#################
#summary V card + Monarch
#################
112 genes in 40 orthogroups, 55 annotated, 18 has GO-terms, representing 12 orthogroups
29 orthogroups were only containing vcard and dplex


