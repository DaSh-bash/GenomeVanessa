knitr::opts_chunk$set(echo = TRUE)
#THIS MUST BE CHANGED!!
plot_title="DTOL_pre"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
library(ggplot2)
library(viridis)
library("tidyr")
library(dplyr)
#THIS MUST BE CHANGED!!
plot_title="DTOL_pre"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(map_ordered, aes(map_ordered$lg, fill=map_ordered$scaffold)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Linkage group by LepMap3") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#in one plot
ggplot(map_ordered, aes(map_ordered$position, map_ordered$male_position, colour=map_ordered$scaffold)) +
geom_point() +
facet_wrap(~map_ordered$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#in maporder
ggplot(map_ordered, aes(as.numeric(rownames(map_ordered)), map_ordered$male_position)) +
geom_point(aes(colour=map_ordered$scaffold)) +
facet_wrap(~map_ordered$lg, scales = "free_x") +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#separate fig for all
for (i in 1:31){
marey_title=paste(plot_title,"LG",i)
print(ggplot(map_ordered[map_ordered$lg== i, ], aes(map_ordered[map_ordered$lg==i, ]$position, map_ordered[map_ordered$lg==i, ]$male_position, colour=map_ordered[map_ordered$lg==i, ]$scaffold)) +
geom_point() +
#facet_wrap(~map_lg1$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10)) +
labs(title = marey_title))
}
#THIS MUST BE CHANGED!!
plot_title="DTOL_pre"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(map_ordered, aes(map_ordered$lg, fill=map_ordered$scaffold)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Linkage group by LepMap3") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#in one plot
ggplot(map_ordered, aes(map_ordered$position, map_ordered$male_position, colour=map_ordered$scaffold)) +
geom_point() +
facet_wrap(~map_ordered$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#in maporder
ggplot(map_ordered, aes(as.numeric(rownames(map_ordered)), map_ordered$male_position)) +
geom_point(aes(colour=map_ordered$scaffold)) +
facet_wrap(~map_ordered$lg, scales = "free_x") +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#separate fig for all
# for (i in 1:31){
#
# marey_title=paste(plot_title,"LG",i)
# print(ggplot(map_ordered[map_ordered$lg== i, ], aes(map_ordered[map_ordered$lg==i, ]$position, map_ordered[map_ordered$lg==i, ]$male_position, colour=map_ordered[map_ordered$lg==i, ]$scaffold)) +
#   geom_point() +
#   #facet_wrap(~map_lg1$lg) +
#   scale_colour_discrete(guide_legend(title="Scaffold")) +
#   xlab("Position (bp)") +
#   ylab("Distance (cM)") +
#   theme(panel.background = element_blank(),
#         axis.line = element_line(size = 1),
#         axis.text = element_text(size = 10),
#         axis.title.x = element_text(size = 10),
#         axis.title.y = element_text(size = 10),
#         legend.text = element_text(size = 10)) +
#   labs(title = marey_title))
# }
#
#
knitr::opts_chunk$set(echo = TRUE)
#THIS MUST BE CHANGED!!
plot_title="DTOL_post"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("mapped/order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
library(ggplot2)
library(viridis)
library("tidyr")
library(dplyr)
#THIS MUST BE CHANGED!!
plot_title="DTOL_post"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("mapped/order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(map_ordered, aes(map_ordered$lg, fill=map_ordered$scaffold)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Linkage group by LepMap3") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#in one plot
ggplot(map_ordered, aes(map_ordered$position, map_ordered$male_position, colour=map_ordered$scaffold)) +
geom_point() +
facet_wrap(~map_ordered$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#in maporder
ggplot(map_ordered, aes(as.numeric(rownames(map_ordered)), map_ordered$male_position)) +
geom_point(aes(colour=map_ordered$scaffold)) +
facet_wrap(~map_ordered$lg, scales = "free_x") +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#separate fig for all
# for (i in 1:31){
#
# marey_title=paste(plot_title,"LG",i)
# print(ggplot(map_ordered[map_ordered$lg== i, ], aes(map_ordered[map_ordered$lg==i, ]$position, map_ordered[map_ordered$lg==i, ]$male_position, colour=map_ordered[map_ordered$lg==i, ]$scaffold)) +
#   geom_point() +
#   #facet_wrap(~map_lg1$lg) +
#   scale_colour_discrete(guide_legend(title="Scaffold")) +
#   xlab("Position (bp)") +
#   ylab("Distance (cM)") +
#   theme(panel.background = element_blank(),
#         axis.line = element_line(size = 1),
#         axis.text = element_text(size = 10),
#         axis.title.x = element_text(size = 10),
#         axis.title.y = element_text(size = 10),
#         legend.text = element_text(size = 10)) +
#   labs(title = marey_title))
# }
#
#
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(viridis)
library("tidyr")
library(dplyr)
#THIS MUST BE CHANGED!!
plot_title="DTOL"
#THIS MUST BE CHANGED!!
map_ordered <- read.table("mapped/order_all2.table", header=T)
str(map_ordered)
paste("Result from OrderMarker for:", plot_title)
#No markers per scaffold and lg
#apply(df[c("Q1", "Q2")], 2, table)
#No markers in map
paste("Number of markers in LG:", length(map_ordered$marker_nr))
apply(map_ordered[c("lg")], 2, table)
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per LG:")
aggregate(map_ordered$male_position, list(map_ordered$lg), max)
#total length
paste("Total map length:",
sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)[,2]))
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_ordered$lg <- as.factor(map_ordered$lg)
plot(map_ordered$lg)
ggplot(map_ordered, aes(map_ordered$scaffold, fill=map_ordered$lg)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="LG")) +
labs(title = plot_title) +
xlab("HiC-scaffold") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(map_ordered, aes(map_ordered$lg, fill=map_ordered$scaffold)) +
geom_bar() +
scale_fill_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Linkage group by LepMap3") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#in one plot
ggplot(map_ordered, aes(map_ordered$position, map_ordered$male_position, colour=map_ordered$scaffold)) +
geom_point() +
facet_wrap(~map_ordered$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#in one plot
ggplot(map_ordered, aes(map_ordered$position, map_ordered$male_position, colour=map_ordered$lg)) +
geom_point() +
facet_wrap(~map_ordered$scaffold) +
scale_colour_discrete(guide_legend(title="lg")) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#in maporder
ggplot(map_ordered, aes(as.numeric(rownames(map_ordered)), map_ordered$male_position)) +
geom_point(aes(colour=map_ordered$scaffold)) +
facet_wrap(~map_ordered$lg, scales = "free_x") +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#separate fig for all
for (i in 1:31){
marey_title=paste(plot_title,"LG",i)
print(ggplot(map_ordered[map_ordered$lg== i, ], aes(map_ordered[map_ordered$lg==i, ]$position, map_ordered[map_ordered$lg==i, ]$male_position, colour=map_ordered[map_ordered$lg==i, ]$scaffold)) +
geom_point() +
#facet_wrap(~map_lg1$lg) +
scale_colour_discrete(guide_legend(title="Scaffold")) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10)) +
labs(title = marey_title))
}
#
#
list_all_files <- paste("ordered.", c(1:31),".mapped.txt", sep = "")
list_all_files
list_neg_files <- paste("ordered.", c(2,5,7,8,9,10,11,15,17,19,23,24,26,28,30),".mapped.txt", sep = "")
anti_join(list_neg_files, list_all_files)
intersect(list_neg_files, list_all_files)
setdiff(list_neg_files, list_all_files)
list_rest_files <- list_all_files[!list_all_files %in% list_neg_files]
list_rest_files
print(head(chr))
write.table(chr, file = newpathfile, col.names = FALSE, row.names = FALSE, quote = FALSE)
for (i in list_rest_files) {
#print(i)
pathfile=paste("~/Desktop/link_map_vanessa/output/LepMak3r_dtol/mapped_pruned/",i, sep = "")
newpathfile=paste("~/Desktop/link_map_vanessa/output/LepMak3r_dtol/mapped_rearr/",i, sep = "")
#read file
chr <- read.table(pathfile)
# #keep only first 4 columns
chr <- chr[,1:4]
# #reverse map
chr$V2 <- chr$V2 - min(chr$V2)
print(head(chr))
# #write file
write.table(chr, file = newpathfile, col.names = FALSE, row.names = FALSE, quote = FALSE)
}
for (i in list_neg_files) {
#print(i)
pathfile=paste("~/Desktop/link_map_vanessa/output/LepMak3r_dtol/mapped_pruned/",i, sep = "")
newpathfile=paste("~/Desktop/link_map_vanessa/output/LepMak3r_dtol/mapped_rearr/",i, sep = "")
#read file
chr <- read.table(pathfile)
# #keep only first 4 columns
chr <- chr[,1:4]
# #reverse map
chr$V2 <- max(chr$V2) - chr$V2
print(head(chr))
# #write file
write.table(chr, file = newpathfile, col.names = FALSE, row.names = FALSE, quote = FALSE)
}
