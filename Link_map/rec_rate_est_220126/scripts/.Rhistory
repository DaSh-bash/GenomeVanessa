#         legend.text = element_text(size = 10))
#
#
#in one plot
ggplot(rec_rate, aes(rec_rate$phys, log(rec_rate$loess))) +
geom_point() +
geom_line(aes(colour=rec_rate$map)) +
#facet_wrap(~rec_rate$map, scales = "free") +
guides(colour=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#chr length and rate
ggplot(rec_rate_mean, aes(rec_rate_mean$chr_length,rec_rate_mean$loess)) +
geom_point() +
geom_smooth(method = "lm") +
labs(title = "Correlation rec rate (2mb window) and chromosome size") +
ylab("cM/Mb") +
xlab("Chromosome length (Mbp)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(rec_rate_mean, aes(rec_rate_mean$chr_length,rec_rate_mean$marker_density)) +
geom_point() +
geom_smooth(method = "lm") +
labs(title = "Correlation marker density and chromosome size") +
ylab("Marker density") +
xlab("Chromosome length (Mbp)") +
ggpubr::stat_cor(method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = "left",
label.y.npc = "top",
geom = "text",
size = 1.5,
show.legend = NA) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(rec_rate_mean, aes(rec_rate_mean$marker_density, rec_rate_mean$loess)) +
geom_point() +
geom_smooth(method = "lm") +
labs(title = "Correlation marker density and recombination rate") +
ylab("cM/Mb") +
xlab("Marker density (per Mb)") +
ggpubr::stat_cor(method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = "left",
label.y.npc = "top",
geom = "text",
size = 1.5,
show.legend = NA) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#excluding 55
ggplot(rec_rate_mean[1:30,], aes(marker_density, loess)) +
geom_point() +
geom_smooth(method = "lm") +
labs(title = "Correlation marker density and recombination rate, excluding 55") +
ylab("cM/Mb") +
xlab("Marker density (per Mb)") +
ggpubr::stat_cor(method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = "left",
label.y.npc = "top",
geom = "text",
size = 1.5,
show.legend = NA) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#coorelation differetn measures of rec rate
ggplot(rec_rate_mean, aes(rec_rate_mean$loess, rec_rate_mean$wind1mb)) +
geom_point() +
#geom_smooth(method = "lm") +
labs(title = "Correlation recombination rate maplength/chrsize and window based") +
ylab("cM/Mb (windows)") +
xlab("cM/Mb (maplength/chrsize)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#plot marey maps
ggplot(rec_rate, aes(rec_rate$phys/1000000, rec_rate$gen)) +
geom_point(size=0.2, colour="black") +
facet_wrap(~rec_rate$map, scales="free") +
ylab("Genetic distance (cM)") +
xlab("Physical position (Mb)") +
ggpubr::stat_cor(method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = "left",
label.y.npc = "top",
geom = "text",
size = 1.5,
show.legend = NA) +
theme_classic()
#ggsave("../figures/marey_maps.pdf", device = "pdf", height = 6, width = 9)
ggplot(rec_rate, aes(rec_rate$phys/1000000, rec_rate$loess)) +
geom_point(size = 0.2) +
geom_line(size = 0.1) +
facet_wrap(~rec_rate$map, scales = "free_x") +
scale_y_continuous(limits = c(0,max(rec_rate$loess))) +
ylab("Recombination rate (cM/Mb)") +
xlab("Physical position (Mb)") +
theme_classic()
#ggsave("../figures/rec_rate_along_chr.pdf", device = "pdf", height = 6, width = 9)
#chr length and rate blue, points only contour (blue) filled Z dark blue
ggplot(rec_rate_mean, aes(rec_rate_mean$chr_length,rec_rate_mean$loess)) +
geom_smooth(method = "lm", colour="#249EA0", fill="#249EA0") +
geom_pointrange(aes(ymin=rec_rate_mean$loess-rec_rate_mean$loess_sd, ymax=rec_rate_mean$loess+rec_rate_mean$loess_sd), size=0.2) +
geom_point(aes(colour=rec_rate_mean$chr_type, fill=rec_rate_mean$chr_type),size=3, shape=21) +
ylab("Recombination rate (cM/Mb)") +
xlab("Chromosome length (Mb)") +
scale_color_discrete(type = c("#249EA0", "#005F60")) +
scale_fill_discrete(type = c("white", "#005F60")) +
#scale_shape_manual(values=c(21,22)) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = c(0.8,0.8)) #+
#ggsave("../figures/rec_rate_vs_chr_length.pdf", device = "pdf")#saved as pdf
#regional variation
#plot recombination rate per Mb (2 Mb window) filled z
ggplot(rec_rate, aes(rec_rate$rel_pos, rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
scale_fill_discrete(type = c("white", "#FD5900")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank())
#folded
ggplot(rec_rate, aes((sqrt((rec_rate$rel_pos-50)^2)), rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
scale_fill_discrete(type = c("white", "#FD5900")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank())
#folded regional rec rate autosome blue, z filled dark blue
ggplot(rec_rate, aes((sqrt((rec_rate$rel_pos-50)^2)), rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("#249EA0", "#005F60")) +
scale_fill_discrete(type = c("white", "#005F60")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
#ggsave("../figures/rec_rate_regional.pdf", device = "pdf")
#create black and white palett
palette <- rep(c("light grey", "white"), length.out = length(unique(rec_rate$map)))
palette_blue <- rep(c("#a7d8d9", "#d3eded"), length.out = length(unique(rec_rate$map)))
#plot recombination rate per Mb (2 Mb window)
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=0, ymax=16, fill=rec_rate$map, alpha=0.5)) +
geom_point(size=0.4) +
geom_line(size=0.2) +
scale_fill_manual(values = palette_blue) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=0, ymax=16, fill=rec_rate$map, alpha=0.5)) +
geom_point(size=0.4) +
#geom_line(size=0.2) +
geom_smooth(method = "loess", span=0.1,colour="#249EA0", fill="#249EA0") +
scale_fill_manual(values = palette_blue) +
guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#across the genome, blue with marked Z
ggplot(rec_rate, aes(rec_rate$genome_pos/1000000, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start/1000000, xmax=rec_rate$chr_start/1000000+rec_rate$chr_length/1000000, ymin=0, ymax=max(rec_rate$loess, na.rm = T), fill=rec_rate$map, alpha=0.5)) +
geom_rect(aes(xmin=rec_rate$chr_start[1], xmax=rec_rate$chr_length[1]/1000000, ymin=0, ymax=max(rec_rate$loess, na.rm = T), alpha=0.5,colour="#FD5900", fill=rec_rate$map), size=1) +
geom_point(size=0.4) +
#geom_line(size=0.2) +
geom_smooth(method = "loess", span=0.1,colour="#249EA0", fill="#249EA0") +
scale_fill_manual(values = palette_blue) +
guides(fill=FALSE, alpha=FALSE, colour=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#ggsave("../figures/rec_rate_across_genome.pdf", device = "pdf")
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
annotate(geom = "rect", xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=-0.2, ymax=max(rec_rate$loess, na.rm = T), fill="light grey", colour="white") +
geom_point(size=0.4) +
geom_smooth(method = "loess", span=0.1, colour="#249EA0", fill="#249EA0") +
#geom_line(size=0.2) +
#scale_fill_manual() +
#guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.5, colour = "grey"),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12))
ggplot(rec_rate, aes(rec_rate$pos_group, rec_rate$loess)) +
geom_boxplot(fill="#249EA0", colour="dark grey") +
ylab("cM/Mb") +
xlab("Distance from chromosome center (10% bins)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.5, colour = "grey"),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12))
#regional rec rate per chromosome
ListChr <- unique(rec_rate$map)
#for (i in ListChr){
plotTitle=paste("Chr",i)
#plot marey maps
ggplot(rec_rate, aes(rec_rate$phys/1000000, rec_rate$gen)) +
geom_point(size=0.2, colour="black") +
facet_wrap(~rec_rate$map, scales="free") +
ylab("Genetic distance (cM)") +
xlab("Physical position (Mb)") +
ggpubr::stat_cor(method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = "left",
label.y.npc = "top",
geom = "text",
size = 1.5,
show.legend = NA) +
theme_classic()
ggsave("../figures/marey_maps.pdf", device = "pdf", height = 6, width = 9)
ggplot(rec_rate, aes(rec_rate$phys/1000000, rec_rate$loess)) +
geom_point(size = 0.2) +
geom_line(size = 0.1) +
facet_wrap(~rec_rate$map, scales = "free_x") +
scale_y_continuous(limits = c(0,max(rec_rate$loess))) +
ylab("Recombination rate (cM/Mb)") +
xlab("Physical position (Mb)") +
theme_classic()
#ggsave("../figures/rec_rate_along_chr.pdf", device = "pdf", height = 6, width = 9)
#chr length and rate blue, points only contour (blue) filled Z dark blue
ggplot(rec_rate_mean, aes(rec_rate_mean$chr_length,rec_rate_mean$loess)) +
geom_smooth(method = "lm", colour="#249EA0", fill="#249EA0") +
geom_pointrange(aes(ymin=rec_rate_mean$loess-rec_rate_mean$loess_sd, ymax=rec_rate_mean$loess+rec_rate_mean$loess_sd), size=0.2) +
geom_point(aes(colour=rec_rate_mean$chr_type, fill=rec_rate_mean$chr_type),size=3, shape=21) +
ylab("Recombination rate (cM/Mb)") +
xlab("Chromosome length (Mb)") +
scale_color_discrete(type = c("#249EA0", "#005F60")) +
scale_fill_discrete(type = c("white", "#005F60")) +
#scale_shape_manual(values=c(21,22)) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.key = element_blank(),
legend.position = c(0.8,0.8)) #+
ggsave("../figures/rec_rate_vs_chr_length.pdf", device = "pdf")#saved as pdf
#regional variation
#plot recombination rate per Mb (2 Mb window) filled z
ggplot(rec_rate, aes(rec_rate$rel_pos, rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
scale_fill_discrete(type = c("white", "#FD5900")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank())
#folded
ggplot(rec_rate, aes((sqrt((rec_rate$rel_pos-50)^2)), rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
scale_fill_discrete(type = c("white", "#FD5900")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank())
#folded regional rec rate autosome blue, z filled dark blue
ggplot(rec_rate, aes((sqrt((rec_rate$rel_pos-50)^2)), rec_rate$loess)) +
geom_point(aes(colour=rec_rate$chr_type, fill=rec_rate$chr_type), shape=21) +
#geom_line() +
geom_smooth(method = "loess", colour="#249EA0", fill="#249EA0") +
ylab("cM/Mb") +
xlab("Relative position") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
scale_colour_discrete(type = c("#249EA0", "#005F60")) +
scale_fill_discrete(type = c("white", "#005F60")) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.key=element_blank(),
legend.title = element_blank())
ggsave("../figures/rec_rate_regional.pdf", device = "pdf")
#create black and white palett
palette <- rep(c("light grey", "white"), length.out = length(unique(rec_rate$map)))
palette_blue <- rep(c("#a7d8d9", "#d3eded"), length.out = length(unique(rec_rate$map)))
#plot recombination rate per Mb (2 Mb window)
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=0, ymax=16, fill=rec_rate$map, alpha=0.5)) +
geom_point(size=0.4) +
geom_line(size=0.2) +
scale_fill_manual(values = palette_blue) +
scale_colour_discrete(type = c("dark grey", "#FD5900")) +
guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=0, ymax=16, fill=rec_rate$map, alpha=0.5)) +
geom_point(size=0.4) +
#geom_line(size=0.2) +
geom_smooth(method = "loess", span=0.1,colour="#249EA0", fill="#249EA0") +
scale_fill_manual(values = palette_blue) +
guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
#across the genome, blue with marked Z
ggplot(rec_rate, aes(rec_rate$genome_pos/1000000, rec_rate$loess)) +
geom_rect(aes(xmin=rec_rate$chr_start/1000000, xmax=rec_rate$chr_start/1000000+rec_rate$chr_length/1000000, ymin=0, ymax=max(rec_rate$loess, na.rm = T), fill=rec_rate$map, alpha=0.5)) +
geom_rect(aes(xmin=rec_rate$chr_start[1], xmax=rec_rate$chr_length[1]/1000000, ymin=0, ymax=max(rec_rate$loess, na.rm = T), alpha=0.5,colour="#FD5900", fill=rec_rate$map), size=1) +
geom_point(size=0.4) +
#geom_line(size=0.2) +
geom_smooth(method = "loess", span=0.1,colour="#249EA0", fill="#249EA0") +
scale_fill_manual(values = palette_blue) +
guides(fill=FALSE, alpha=FALSE, colour=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.2, colour = "grey"),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10))
ggsave("../figures/rec_rate_across_genome.pdf", device = "pdf")
ggplot(rec_rate, aes(rec_rate$genome_pos, rec_rate$loess)) +
annotate(geom = "rect", xmin=rec_rate$chr_start, xmax=rec_rate$chr_start+rec_rate$chr_length, ymin=-0.2, ymax=max(rec_rate$loess, na.rm = T), fill="light grey", colour="white") +
geom_point(size=0.4) +
geom_smooth(method = "loess", span=0.1, colour="#249EA0", fill="#249EA0") +
#geom_line(size=0.2) +
#scale_fill_manual() +
#guides(fill=FALSE, alpha=FALSE) +
ylab("cM/Mb") +
xlab("Mb") +
scale_y_continuous(expand = c(0.01,0.05)) +
scale_x_continuous(expand = c(0.01,0.05)) +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.5, colour = "grey"),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12))
ggplot(rec_rate, aes(rec_rate$pos_group, rec_rate$loess)) +
geom_boxplot(fill="#249EA0", colour="dark grey") +
ylab("cM/Mb") +
xlab("Distance from chromosome center (10% bins)") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 0.5, colour = "grey"),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12))
ggsave("../figures/boxplot_pos.pdf", device = "pdf")
#regional rec rate per chromosome
ListChr <- unique(rec_rate$map)
for (i in ListChr){
plotTitle=paste("Chr",i)
print(ggplot(rec_rate[rec_rate$map==i,], aes(rec_rate[rec_rate$map==i,]$phys, rec_rate[rec_rate$map==i,]$loess)) +
geom_point() +
geom_line() +
#facet_wrap(~rec_rate$map, scales = "free") +
scale_y_continuous(limits = c(0,rec_rate$loess)) +
labs(title = plotTitle) +
ylab("cM/Mb") +
xlab("Mb") +
theme(panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.text = element_text(size = 10)))
}
ggplot(rec_rate, aes(rec_rate$phys/1000000, rec_rate$loess)) +
geom_point(size = 0.2) +
geom_line(size = 0.1) +
facet_wrap(~rec_rate$map, scales = "free_x") +
scale_y_continuous(limits = c(0,max(rec_rate$loess))) +
ylab("Recombination rate (cM/Mb)") +
xlab("Physical position (Mb)") +
theme_classic()
ggsave("../figures/rec_rate_along_chr.pdf", device = "pdf", height = 6, width = 9)
write.table(rec_rate_mean, "../tables/summary_per_chromosome_loess.table", quote = F)
write.table(rec_rate, "../tables/rec_rate_windows_loess.table")
head(rec_rate)
