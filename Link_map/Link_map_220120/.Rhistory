#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin/ordered.31.1.intervals_mod.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod/ordered.31.2.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod2/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval/ordered.31.3.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin/ordered.31.1.intervals_mod.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod2/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval/ordered.31.3.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin/ordered.31.1.intervals.mapped")
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod2/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_31_mod <- read.table("chr_54_55/last_reeval_55/Ordermarker_reeval_thin_mod/ordered.31.1.intervals.mapped")
plot_title=unique(map_31_mod$V4)
ggplot(map_31_mod) +
#geom_point() +
geom_linerange(mapping=aes(x=V5, ymin=V2, ymax=V3, colour=V4), size=0.2) +
geom_point(mapping=aes(x=V5, y=V2, colour=V4), size=0.5) +
geom_point(mapping=aes(x=V5, y=V3, colour=V4), size=0.5) +
#facet_wrap(~map_for_HiC$V1, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
head(map_ordered)
head(map_ordered)
head(map_ordered)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt", header=T)
head(map_ordered)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
head(map_ordered)
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
head(map_ordered)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
head(map_interval)
colnames(map_ordered) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
plot_title="Maps for ms"
ggplot(map_ordered) +
#geom_point() +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
#map_ordered_plot
plot_title="Maps for ms"
ggplot(map_ordered) +
#geom_point() +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
#map_interval_plot
plot_title=
ggplot(map_interval) +
#geom_point() +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
ggplot(map_interval) +
#geom_point() +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
map_interval$scaffold <- as.factor(map_interval$scaffold)
ggplot(map_interval) +
#geom_point() +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
str(map_interval)
ggplot(map_interval) +
#geom_point() +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
ggplot(map_ordered) +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
ggplot(map_ordered) +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
str(map_ordered)
ggplot(map_ordered) +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#maps sorted after lg
ggplot(map_for_HiC) +
#geom_point() +
geom_linerange(data=map_for_HiC, mapping=aes(x=V2, ymin=V5, ymax=V6, colour=V1), size=0.2) +
geom_point(data=map_for_HiC, mapping=aes(x=V2, y=V5, colour=V1), size=0.5) +
geom_point(data=map_for_HiC, mapping=aes(x=V2, y=V6, colour=V1), size=0.5) +
facet_wrap(~map_for_HiC$V3, scales="free_y") +
ggpubr::stat_cor(aes(x=V2, y=(V5+V6)/2, colour=NULL), method = "pearson",
cor.coef.name = "R",
label.sep = ", ",
r.accuracy = 0.01,
p.accuracy = 0.0001,
label.x.npc = 0.25,
label.y.npc = "top",
geom = "text",
size = 2,
show.legend = NA) +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(viridis)
library("tidyr")
library(dplyr)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
str(map_ordered)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
str(map_interval)
head(map_interval)
map_interval$scaffold <- as.factor(map_interval$scaffold)
plot_title="maps for ms"
ggplot(map_ordered) +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
ggplot(map_interval) +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
str(map_interval)
head(map_interval)
map_interval$scaffold <- as.factor(map_interval$scaffold)
plot_title="maps for ms"
paste("Result for:", plot_title)
#Number of markers in map
paste("Number of markers in LG:", length(map_ordered$position))
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per scaffold min and max: ")
#cbind(aggregate(map_ordered$distance_min, list(map_ordered$scaffold), max), aggregate(map_ordered$distance_max, list(map_ordered$scaffold), max))
aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)
paste("Total map length (cM): ",sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)$x))
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
str(map_interval)
head(map_interval)
map_interval$scaffold <- as.factor(map_interval$scaffold)
plot_title="maps for ms"
paste("Result for:", plot_title)
#Number of markers in map
paste("Number of markers in LG:", length(map_ordered$position))
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per scaffold min and max: ")
#cbind(aggregate(map_ordered$distance_min, list(map_ordered$scaffold), max), aggregate(map_ordered$distance_max, list(map_ordered$scaffold), max))
aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)
paste("Total map length (cM): ",sum(aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)$x))
paste("Appr recombination rate (cM/Mb):", sum(aggregate(map_ordered$male_position, list(map_ordered$lg), max)$x)/sum(aggregate(map_ordered$position, list(map_ordered$scaffold), max)$x)*1000000)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
str(map_interval)
head(map_interval)
map_interval$scaffold <- as.factor(map_interval$scaffold)
plot_title="maps for ms"
paste("Result for:", plot_title)
#Number of markers in map
paste("Number of markers in LG:", length(map_ordered$position))
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per scaffold min and max: ")
#cbind(aggregate(map_ordered$distance_min, list(map_ordered$scaffold), max), aggregate(map_ordered$distance_max, list(map_ordered$scaffold), max))
aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)
paste("Total map length (cM): ",sum(aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)$x))
paste("Appr recombination rate (cM/Mb):", sum(aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)$x)/sum(aggregate(map_ordered$position, list(map_ordered$scaffold), max)$x)*1000000)
#total length to get cM divide by nr of offspring then *100
paste("Total map length (cM), min:", 100*sum(aggregate(map_interval$distance_min, list(map_interval$scaffold), max)[,2])/90)
map_ordered <- read.table("maps_for_ms/order_all_dist.txt")
colnames(map_ordered) <- c("marker_nr", "male_position", "scaffold", "position")
str(map_ordered)
head(map_ordered)
map_ordered$scaffold <- as.factor(map_ordered$scaffold)
map_interval <- read.table("maps_for_ms/order_all_int.txt")
colnames(map_interval) <- c("marker_nr", "int_min", "int_max", "scaffold", "position")
str(map_interval)
head(map_interval)
map_interval$scaffold <- as.factor(map_interval$scaffold)
plot_title="maps for ms"
paste("Result for:", plot_title)
#Number of markers in map
paste("Number of markers in LG:", length(map_ordered$position))
apply(map_ordered[c("scaffold")], 2, table)
#maplength
print("Map length per scaffold min and max: ")
#cbind(aggregate(map_ordered$distance_min, list(map_ordered$scaffold), max), aggregate(map_ordered$distance_max, list(map_ordered$scaffold), max))
aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)
paste("Total map length (cM): ",sum(aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)$x))
paste("Appr recombination rate (cM/Mb):", sum(aggregate(map_ordered$male_position, list(map_ordered$scaffold), max)$x)/sum(aggregate(map_ordered$position, list(map_ordered$scaffold), max)$x)*1000000)
#total length to get cM divide by nr of offspring then *100
paste("Total map length (cM), min:", 100*sum(aggregate(map_interval$int_min, list(map_interval$scaffold), max)[,2])/90)
paste("Total map length (cM), max:", 100*sum(aggregate(map_interval$int_max, list(map_interval$scaffold), max)[,2])/90)
#map_ordered_plot
plot_title="Maps for ms"
ggplot(map_ordered) +
geom_point(mapping=aes(x=position, y=male_position), size=0.5) +
facet_wrap(~map_ordered$scaffold, scales="free_y") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance (cM)") +
theme_classic()
#map_interval_plot
ggplot(map_interval) +
geom_linerange(mapping=aes(x=position, ymin=int_min, ymax=int_max), size=0.2) +
geom_point(mapping=aes(x=position, y=int_min), size=0.5) +
geom_point(mapping=aes(x=position, y=int_max), size=0.5) +
facet_wrap(~map_interval$scaffold, scales="free") +
#scale_colour_manual(values = c("grey14", "red")) +
guides(colour=FALSE) +
labs(title = plot_title) +
xlab("Position (bp)") +
ylab("Distance, #recombinations") +
theme_classic()
knitr::opts_chunk$set(echo = TRUE)
library(MareyMap)
install.packages(MareyMap)
install.packages(tcltk)
install.packages(tkrplot)
install.packages(tools)
install.packages(MareyMap)
install.packages("MareyMap")
library(MareyMap)
library(MareyMap)
library(ggplot2)
library(viridis)
library("tidyr")
library(plyr)
library(dplyr)
startMareyMapGUI()
#check negative maps for reversing them
#split the order_all-file with
#list_neg <- list(3,10,13,16,18,24,25,26,28,29)
list_neg_files <- paste("LR9999",c(24,26,28,30,32,33,34,36,45,50,54,55),".1", sep = "")
getwd()
